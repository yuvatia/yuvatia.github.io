export const frontmatter = {
    title: 'Projective Geometry',
    date: '2024-06-02'
};

This post is meant to serve as a somewhat thorough introduction to projective geomety - the geometry of vision. It is heavily based on the excellent [Geometry of Vision](https://this-vijay.github.io/vision-math/), which can also be viewed on [YouTube](https://www.youtube.com/playlist?list=PLyqSpQzTE6M_bepAWap9JE-i9UiO6-y_f) taught by Prof. Vijay Ravikumar at NPTEL, although some major changes have been made and additional content has been added, especially near the end of the article, tying it all back together to the most practical usage of the subject in computer graphics. This is a long post, and to be able to truly get value from it, you are encouraged to follow along with the exercises and proofs, and to take your time to understand the concepts presented. This is especially relevant for synthetic proofs and constructions, which while I did attempt to the best of my ability to present in a clear manner and to accompany any non-trivial construction with a sketch, are still best understood when attempted by the reader.

## Euclidean Geometry

One of the first mathematical fields taught to children is that of geometry, specifically Eucledian geometry, laid out by Euclid in *The Elements*. In *Elements*, Euclid first discusses the two dimensional case - plane geometry, and then extends it to three dimensions - solid geometry. In order to properly establish all propositions which describe Euclidean geometry, Euclid introduces a set of axioms, which are taken to be true, and are then used to prove other propositions. One such axiom is that *for any two points, there exists a straight line connecting them*. Note that the axiom does not define what a "point" or a "line" is, they are taken as [primitive notions](https://en.wikipedia.org/wiki/Primitive_notion) - concepts which are not defined by previous concepts. Instead, the axioms describe the relationships between these primitive notions. This distinction lets us change our notion of points or lines, long as the new notions obey the axioms of Euclidean geometry. As such, Euclidan geometry is an [axiomatic system](https://en.wikipedia.org/wiki/Axiomatic_system) - it is a set of primitive notions (for example - line, point, plane) and axioms describing their relationships (for example, the one we presented earlier), used to logically derive theorems.

The axioms of Euclidean plane geometry presented in Elements are:

1. For any two points, there exists a straight line connecting them.
2. Any finite line segment can be extended indefinitely in a straight line.
3. A circle can be drawn with any center and any radius.
4. All right angles are equal to one another.
5. If a line segment intersects two straight lines forming two interior angles on the same side that sum to less than two right angles, then the two lines, if extended indefinitely, meet on that side on which the angles sum to less than two right angles.

The last axiom is known as the [parallel postulate](https://en.wikipedia.org/wiki/Parallel_postulate), and can be better understood by considering the following diagram:

![Parallel postulate](/images/00_parallel_postulate.png)

The axiom postulates that if $$\alpha + \beta \lt 180\degree$$, the two white lines will intersect at some point $A$ on the same side of the plane where the angles are considered. In the case where $\alpha + \beta = 180 \degree$, then the sum of the interior angles will never be less than two right angles, and the two lines will never intersect. This is the case when the two lines are parallel.

While the first four axioms were generally accepted as true, the fifth axiom was a source of contention for many years, with many attempts at proving it based on the rest of the axioms, or deriving it by introducing less arbitrary axioms. The most well-known of these attempts is [Playfair's axiom](https://en.wikipedia.org/wiki/Playfair%27s_axiom), which is somewhat more common in modern teaching of Euclidean geometry. Playfair's axiom states that *for any line and a point not on it, at most one line parallel to the given line can be drawn through the point*. This axiom, combined with the first four axioms, can be used to prove the parallel postulate.

There have also been geometries which discard the parallel postulate entirely, with one key example being [Absolute geometry](https://en.wikipedia.org/wiki/Absolute_geometry), which is a geometry derived from the first four axioms alone, and as such can be considered a generalization of Euclidean geometry, with results that apply to other geometries as well, long as they fulfill the first four axioms.

While Euclidean geometry is, in a sense, a very natural geometry, one can ask what would happen if we were to derive a geometry based of a different set of axioms. How will such a geometry function, and what will its properties be? And of what value would it be to study such a geometry?

## Perspective Drawing

Consider the world outside your window. The world is three-dimensional, yet the window can be approximated as a two-dimensional plane. We can think of the window as a canvas, and the world outside as an ever-changing image drawn on the canvas. In modern days, we can easily capture such two-dimensional images of the world, using our phone's camera. If you were tasked with drawing an accurate represntation of a railway track, for example, you could just take a photo of such track with your phone and trace over it. This however would not have been possible in the past, when perspective drawing evolved. Perspective drawing is a technique used by artists to represent three-dimensional objects on a two-dimensional surface, such as paper or canvas, in a way that attempts to immitate how the human eye perceives the world, and was developed during the rennisance era. This technique can be used to create realistic images of the world, as if the image were a true window to another world.

The governing principles of perspective drawing are as follows:
1. Lines and points in the real world (henceforth referred to as "Euclidean space") are transformed to lines and points respectively in the image plane (henceforth referred to as "projective plane").
2. All lines which are not parallel to the picture plane intersect at a single point. Note that this includes lines which are parallel in Euclidean space.
3. Families of parallel lines in Euclidean space intersect at a single point in the projective plane, known as a vanishing point, or a "point at infinity".
4. Every family of parallel Euclidean plane is associated with a projective plane with an added line called the horizon line, or the "line at infinity". All vanishing points of lines on the plane lie on the horizon line.

Consider, for example, attempting to draw a railway track as if the image plane were parallel to the ties. Here's what you'd see in real life you were actually standing in front of the track:

![Railway track](https://upload.wikimedia.org/wikipedia/commons/2/2a/Railroad-Tracks-Perspective.jpg)

Notice how the rails, which are parallel in real life, appear to converge at a single point in the distance. This is the vanishing point of the rails. If you were to draw the track as you see it, you would draw the rails as two lines converging at a single point in the distance. This is the principle of perspective drawing. Also notice how the ties, which are perpendicular to the rails, appear as parallel lines in the image. This is because the ties are parallel to the picture plane, and as such do not seem to converge in our image. One can achieve this effect using only one tie as a starting point using only a straightedge as follows:

<video src="/images/02_railway_track_drawing.mp4" controls></video>

The key to achieving this drawing is to realize that parallel lines in Euclidean space intersect at a single point in the projective plane. The choice of auxilary lines should be made clear by considering a top-down view of the track:

![Top-down view of a railway track](images/03_railway_track_top_down.png)

Note that this is also a perspective drawing, but now the image plane is parallel to the railway plane, thus no vanishing points are present and parallel lines still appear parallel.

Since the rails in our drawing have only one edge not parallel to the image plane, we see only one vanishing point. This is known as a *one-point perspective*. If we were to place the image plane at an angle to the railway plane, we would see two vanishing points, one for each rail. This is known as two-point perspective, and is used to draw objects which are not parallel to the image plane. Here's how one can draw the track at an angle:

<video src="images/04_railway_track_at_angle.mp4" controls></video>

Similarly, we can tile a floor starting from an initial trapezoid as follows:

<video src="images/05_tiling_floor.mp4" controls></video>

Here, the view is also at an angle, meaning no edge is parallel to the image plane. The result are quite convincing.

Now, consider a 3 dimensional object such as a cube. A cube has 3 pairs of parallel faces, setting up 3 sets of parallel planes. Accordingly, there are three ways a cube can be represented in perspective drawing:

1. Front view - the front face is in parallel to the image plane, and as such does not converge, much like our top-down view of the track. As the back face is parallel to the front face, it too does not have any converging edges. The side faces however, are not parallel to the image plane, and as such do converge. Since they are parallel to each other, they converge to the same vanishing point. This is a one point perspective, and can be drawn as follows:

<video src="images/06_one_point_cube.mp4" controls></video>

2. Side view - the cube is placed on the Euclidean plane perpendicular to the image plane but at an angle. Now, we have two vanishing points on the horizon line attached to the Euclidean plane in our image:

<video src="images/07_two_point_cube.mp4" controls></video>

3. The cube isn't laying on the ground, but is instead floating in space. Now, all three sets of parallel planes converge to different vanishing points, but now now all edges lie on the same real plane or on a plane parallel to it, and as such we have a family of parallel edges that converge to a different horizon line, belonging to the new plane. This is known as a three-point perspective, and can be drawn as follows:

<video src="images/08_three_point_cube.mp4" controls></video>

By now, we've seen enough examples of how a perspective can distort the Euclidean space, and how perspective drawing better captures the way we see the world. When attempting to make sense of this new structure, it is a good idea to ask questions about the nature of the transformation - what changes between perspectives? what remains the same? Clearly, angles and lengths are not preserved, meaning this isn't an isometry. However, points and lines are still taken to points and lines, and their meet and join are preserved, yet we have this new property where parallel lines meet at a new point - the vanishing point, which lies on a new line - the horizon line. We will spend the rest of this discussion formalizing this new geometry, and exploring its properties in an attempt to answer these questions and explain our observations.

Before diving into projective geometry properly, it is worth to ask why perspective drawing models the way we see the world. To do this, we shall briefly discuss the human eye and how it perceives the world and present the geometrical optics model of light propagation.

## Geometrical Optics

The simplest model of light propagation is the *ray model*, which is the basis of geometrical optics. In this model, light is represented as rays which obey the following rules (taken from Wikipedia, slightly rephrased):

1. Rays travel in straight-line in a homogenous medium.
2. Rays are reflected or refracted at the interface between two dissimilar media.
3. Rays may be absorbed by the medium.
4. Rays follow curved paths in a medium in which the refractive index changes.

This model, while being very simple, can be used to describe a vast amount of optical phenomena, as we will see in the next section.

### Pinhole Camera Model

Consider a closed box with a small hole on one side, and a screen on the opposite side. Since the box is closed, light may only enter the box through the hole. Now, assume that the hole is so small that it can be approximated as a point $O$. Consider some point $A$ in the outside world, in the halfplane behind the hole. For a light ray starting from $A$ to enter the box, it needs to pass through the hole. Since the hole is approximated as a point, and since light travels in straight lines under the assumption of our model, we know that only one light ray from $A$ may enter the box. This light ray will then hit the screen at some point $A'$, which we call the *image* of $A$. The following illustration shows this setup:

<div align="center">![Pinhole Camera](https://upload.wikimedia.org/wikipedia/commons/3/3b/Pinhole-camera.svg)</div>

An important observation is that, for any point $P$ along the segment $AO$, the image of $P$ will be $A'$, since the light ray from $P$ also enters the box through the same line $AO$ which hits the projective plane at $A'$. This means that the image of a point in 3 dimensional space on the projective plane is independent of the distance of the point from the origin.

We can relate $A$ and $A'$ using similar triangles. Let $A = (X, Y, Z)$ and $A' = (X', Y', Z')$. Let the box be axis-aligned and sitted on the $z$ axis, and let $O$ be the origin. Let the position $z$ direction be towards the world (meaning that the projective plane has a negative $z$ value). Then we know that the projective plane's $z$ component is constant and equals some value $-f$ (for focal distance). Then, the following equations hold:

$$
\frac{X'}{-f} = \frac{X}{Z} \quad \text{and} \quad \frac{Y'}{-f} = \frac{Y}{Z}
$$

Alternatively, we can write:

$$
A':\quad \begin{pmatrix} -f \frac{X}{Z}& -f \frac{Y}{Z}& -f \end{pmatrix}
$$

This means that the image is *inverted*, as illustrated above.

This also means that objects further away from box will appear smaller on the projective plane. This phenomena is known as *perspective*, and helps us perceive depth.

Let's consider the case of two parallel lines, parametrized as:

$$
\begin{gathered}
l_{1}: a_{1} + \vec{v}t \\
l_{2}: a_{2} + \vec{v}t
\end{gathered}
$$

Consider the projected image of some point along the line as a function of $t$. Using our previous equation, we get:

$$
\begin{gathered}
A'_{i}: \quad 
\begin{pmatrix} 
-f \frac{a_{i,x}+v_{x}t}{a_{i,z}+v_{z}t} & 
-f \frac{a_{i,y}+v_{y}t}{a_{i,z}+v_{z}t} &
-f
\end{pmatrix}
\end{gathered}
$$

Which, assuming $t \ne 0$, can be rearranged as:

$$
A'_{i}: \quad
\begin{pmatrix}
-f \frac{\frac{a_{i,x}}{t}+v_{x}}{\frac{a_{i,z}}{t}+v_{z}} &
-f \frac{\frac{a_{i,y}}{t}+v_{y}}{\frac{a_{i,z}}{t}+v_{z}} &
&
-f
\end{pmatrix}
$$

Let's see what happens when $t \to \infty$:

$$
A'_{i}: \quad
\begin{pmatrix}
-f \frac{v_{x}}{v_{z}}&
-f \frac{v_{y}}{v_{z}}&
-f
\end{pmatrix}
$$

Note that this result is independent of the origin of the line $a_{i}$, but rather only depends on the direction of the line, meaning that in the projective plane, parallel lines intersect "at infinity". We call the point where parallel lines intersect the "vanishing point". Also note how the projected lines still remain straight in the sense that they are still linear lines in the projective plane, this can be easily proven by looking at the equation for $A'_{i}$ and seeing that it can be written as a line eqaution:

$$
l'_{i}: \quad a'_{i} + \vec{v}'t
$$

This means that lines in $R^{3}$ are taken to lines in the projective plane, but parallel lines seem to get closer and closer together the further they are from the origin. The following image illustrates this:

![Vanishing point of a railway track](https://upload.wikimedia.org/wikipedia/commons/2/2a/Railroad-Tracks-Perspective.jpg)

The box-with-a-tiny-hole setup we described is called a *camera obscura*, and is the first known camera model. The model described is called the *pinhole camera model*. While easy to reason about, it has one major shortcoming in photography - because the hole is extremely small, very little light enters the box, and the image formed is very dim. This can be accounted for by using materials which respond to light in an accumulative manner, such as film or digital sensors. We then need to *expose* the material to light for some duration of time to receive a better lit image. In photography, this is called *exposure*. While exposure does help, it does not solve the problem of capturing images in a poorly-lit environment. To solve this problem, we need to let more light in, which can be done by widening the hole. This, however, introduces a new problem - now, multiple light rays from the same point enter the box and hit the projective plane at different points, creating a blurry image, a phenomena known as *defocus*. To solve this problem, we need some way of focusing multiple light rays from the same source to the same point on the projective plane, so that we can maintain a sharp image. This is done using lenses - much like the ones we have in our eyes.

### A few words on lenses

When discussing camera lenses, we usually discuss thin lenses, which are lenses with a thickness negligible compared to their focal length, which lets us approximate the lens as a point, simplifying calculations and ray tracing. Generally speaking, we usually discuss two types of lenses - converging (or convex) lenses, that bring parallel rays closer together to form an image, or diverging (concave) lenses, that bring parellel rays further apart, forming a virtual image (much like the image created by a reflective surface such as a mirror). Here's an illustration of converging lenses taken from Wikipedia:

<div align="center">![Converign lenses](https://upload.wikimedia.org/wikipedia/commons/8/8f/Convex_lens_-_perfect.svg)</div>

Since we are about to move away from geometrical optics for the duration of this discussion, we will not delve into the mathematics of lenses. For completeness, we will mention that that lenses give rise to a new phenomena which we didn't have in the pinhole model - due to the geometry of the lens, only objects at one distance can be properly fully focused by the lens, leaving other objects defocused, forming a [circle of confusion](https://en.wikipedia.org/wiki/Circle_of_confusion). This phenomena is closely related to the [depth of field](https://en.wikipedia.org/wiki/Depth_of_field). This is how we percieve the world, so being able to model this phenomena is important if we wish to create more immersive visuals.

## Incidence Geometry

An incidence in geometry is a relation between points and lines which encapsulates the notion of a point lying on a line or a line passing through a point. We say that a line and a point are incident if the point is on the line. Similarly, we say that two lines are incident if they meet at some point (with which both lines are incident). We can describe a system of lines, points and an incidence relation using an incidence structure $(P, L, I)$ where $P$ is a set of points, $L$ is a set of lines, and $I$ is an incidence relation between points and lines (the elements of $I$ are usually called *flags*).

Incidence is one of the concepts we study in Eucledian geometry, along with other concepts such as lengths and angles. As we have seen in our brief overview of perspective drawing, lengths and angles are not preserved under perspective shifts, however incidence is. In particular, we observe that the following incidence relations are preserved under perspective shifts:

1. Two distinct points are incident with exactly one line.
2. Every line is incident with at least two distinct points.

Both the Euclidean space $R^{3}$ and our projective space seem to preserve these relations. An incidence structure $(P, L, I)$ that fulfills these two properties is called a [linear space](https://en.wikipedia.org/wiki/Linear_space_(geometry) (not to be confused with a vector space from linear algebra). There exists a branch of geometry called [incidence geometry](https://en.wikipedia.org/wiki/Incidence_geometry) which is the study of incidence structures, and indeed the most studied incidecne structures in incidence geometry are those which are linear spaces and partial linear subspaces, which is a less structured version of a linear space where the first property (taken as an axiom of the space) is relaxed to state that two distinct points are incident with *at most* one line. Some authors also add a third property, which states that for a structure to be called a linear space it must have at least two distinct lines. This prevents degenerate cases where $P$ and $L$ are empty sets or when $L$ is a set with a single element, which are not very interesting to study.

When formalizing a structure to be used to describe the rules that govern perspective shifts, we will require that the structure be a linear space to conform to the observations we made earlier.

## The Projective Plane

We begin with the two dimensional case. We construct the projective plane by extending the Euclidean plane $R^{2}$ by adding a new set of points and a line, as follows:

1. For every family of parallel lines in $R^{2}$, we add a new point to the projective plane, called the *point at infinity* or the *vanishing point* of the family, which is incident with all lines in the family.
2. We add a new line to the projective plane, called the *line at infinity*, which is incident with all the vanishing points of the families of parallel lines in $R^{2}$.

Note that this structure is actually the union of $R^{2}$ and the line at infinity, which we denote by $\mathbb{l}_{\infty}$. We call this new structure the projective plane $P^{2}$:

$$
P^{2} = R^{2} \cup \mathbb{l}_{\infty}
$$

Let us show that $P^{2}$ is a linear space. When dealing with the projective plane and projective spaces in general, it is often easier to break the statement we wish to prove or examine to cases, and deal with the regular case and the cases involving infinity separately. We shall do the same here: 

1. Let $p_{1}, p_{2}$ be two distinct points in $P^{2}$. By definition, the following cases are possible:
    1. $p_{1}, p_{2} \in R^{2}$, in which case there is exactly one line in $R^{2}$ which is incident with both, satisfying (1).
    2. $p_{1}, p_{2} \notin R^{2}$, in which case both are points at infinity. Since the points at infinity are only incident with a family of parallel lines in $R^{2}$ and with the line at infinity, clearly there is no line from $R^{2}$ which is incident with both points. However, $l_{\infty}$ is by definition incident with both points, satisfying (1).
    3. w.l.o.g, $p_{1} \in R^{2}$ and $p_{2} \notin R^{2}$. In this case, $p_{2}$ is incident with some family of parallel lines $L$. By Playfair's axiom in $R^{2}$, there exists a single line parallel to $L$ that passes through $p_{1}$, which means that this line is in $L$, which means it is also incident with $p_{2}$, satisfying (1).
2. Let $l$ be a line in $P^{2}$. By definition, $l$ is either on $R^{2}$ or it is $\mathbb{l}_{\infty}$. In the former case, $l$ clearly satisfies the second axiom of a linear space since it belongs to $R^{2}$ which is a linear space. In the latter case, $l$ is incident with all lines at infinity by construction, and since $R^{2}$ has at least two non-parallel lines $l_{1}, l_{2}$, we have two distinct points at infinity $P_{[l_{1}]}, P_{[l_{2}]}$ which are incident with $l_{\infty}$ by construction. Thus $P^{2}$ satisfies the second axiom of a linear space.

$P^{2}$ fulfills both axioms of a linear space, thus it is a linear space. We also saw how the line at infinity, which seems somewhat more arbitrary at first, is necessary for $P^{2}$ to be a linear space.

We can now identify the vanishing points from our perspective drawing with the points at infinity in the projective plane. The horizon line in our perspective drawing is the line at infinity in the projective plane. The vanishing points of the lines in the drawing are the points at infinity in the projective plane. The lines in the drawing are the lines in the projective plane. This means that the projective plane is a good model for perspective drawing, as it captures the essence of the drawing. However, there is a catch - in our drawing, when we drew a line parallel to the horizon line, it did not intersect the horizon line. In the projective plane, all lines intersect the line at infinity, so despite being a decent mental model for $P^{2}$, our drawing does not fully capture it.

Another important property of the projective plane that isn't captured in our drawing is the circular nature of lines in $P^{2}$: consider a line $l$ in $P^{2}$. The line is incident with a point at infinity $P_{[l]}$. We can follow the line along two different directions, so it may be tempting to define different points at infinity for each direction, and have two different lines at infinity. This, however, would violate the axioms of a linear space, since we would have two points at infinity incident with the same family of lines, meaning we would have two points which are incident with infinitely many lines, violating the first axiom of a linear space. Instead, we say that the line is incident with $P_{[l]}$ regardless of the direction we choose to follow along, maintaining the axioms of a linear space. This leads to a curious property - every line in $P^{2}$ is a closed curve though its point at infinity - by following the line along one direction, through the point at infinity, we will eventually reach the starting point. Also worth mentioning is the connectivity of regions of the projective plane on different sides of lines. Consider the following image in $R^{2}$:

![A line separates the plane into distinct regions](/images/09_plane_separated_by_line.png)

The line clearly separates $R^{2}$ into two not connected regions. However, if we were to interpret this image in $P^{2}$, we actually would be able to move from one side of the line to the other by following the line through the point at infinity. This is another property worth keeping in mind when attempting to understand the structure of $P^{2}$, meaning that the regions shown in the image are in fact still connected in $P^{2}$.

The branch of geometry that studies this structure is [Projective geometry](https://en.wikipedia.org/wiki/Projective_geometry).

### Duality

Consider the first axiom of a linear space: Two distinct points are incident with exactly one line. Let's see what statement we get when we switch between "lines" and "points": *two distinct lines are incident with exactly one point*. This statement is the *dual* of the first linear space axiom. Clearly, it does not hold in $R^{2}$: let $l_{1}$, $l_{2}$ be two distinct, parallel lines - clearly they do not meet, thus the statement is false. If, however, we consider the lines in $P^{2}$, then there are two possible cases:

1. $l_{1}, l_{2} \in R^{2}$, in which case they are either non-parallel and meet by the parallel postulate at a signle point, or are parallel and are incident with the same point at infinity and only that point.
2. w.l.o.g $l_{1} \in R^{2}$ and $l_{2} \notin R^{2}$. In this case, $l_{2}$ is the line at infinity, which is incident with all points at infinity and only those points. However, $l_{1}$ is also incident with a point at infinity $P_{[l_{1}]}$, thus it is incident with $l_{\infty}$ at $P_{[l_{1}]}$ and only at that point.

So the dual statement holds in $P^{2}$, and we can freely exchange between "points" and "lines" when stating this incidence relation. This is essentially what we mean when we use the term "duality" in the context of projective geometry - a statement holds in $P^{2}$ (and higher dimensions) iff its dual holds. The dual property is stated without proof here, as it is not essential to our discussion, but it is still presented for the sake of completeness.

## The Projective Space

The projective plane $P^{2}$ is an extension of the Euclidean plane $R^{2}$. However, recall that we are also interested in imaging objects inhabiting the Euclidean space $R^{3}$. To do that, we need to extend $P^{2}$ to 3-dimensional space. We do this in a way analogous to our construction of $P^{2}$:

1. For any line $l$ in $R^{3}$, take the equivalance class $[l]$ of that line and then add a point at infinity $P_{[l]}$ for the equivalance class and declare it incident with all lines in $[l]$.
2. For any plane $\pi$ in $R^{3}$, take the equivalance class $[\pi]$ to be all planes parallel to $\pi$, then add a line at infinity $l_{[\pi]}$ incident with all points at infinity of lines in $[\pi]$.
3. Add a new *plane at infinity* $\pi_{\infty}$ incident with all lines at infinity. This is done to maintain the property of Euclidean space where every three non-collinear points determine a plane.

In $R^{2}$, we only had one plane so we needed only one light at infinity. However in $R^{3}$ we have in ifinitely many planes, each with their own line at infinity. For each plane $\pi$, the union $\pi \cup l_{[\pi]}$ is a projective plane, and as we've proven above is a linear space. We call this union the *projective extension P(\pi)* of the plane. We can think of $R^{3}$ as the union of all planes $\pi \subset R^{3}$. Perhaps a more intuitive way to think about $P^{3}$ then is to think of it as the union of all projective extensions of planes in $R^{3}$.

Let's discuss the incidence relation of distinct planes in $P^{3}$. First, recall that in $R^{3}$ planes either are either incident on a shared line, or do not intersect at all (alternatively, we say that their intersection is the empty set). This happens when the normals of the planes are parallel. This property can easily be proven in the field of analytic geometry: consider two planes denoted as $\pi_{1}: (n_{1},d_{1})$ and $\pi_{2}: (n_{2}, d_{2})$ represented by a normal and a distance from the origin. $\pi_{1}$ intersects $\pi_{2}$ only when the following holds:

$$
(n_{1}, d_{1})\cdot(p,1) = 0 \quad \text{and} \quad (n_{2}, d_{2}) \cdot (p, 1) = 0
$$

There are 3 DOFs and two constraints, so assuming the normals are linearly indepdent we have 1 DOF which is geometerically represented by a line shared by both planes. It can also be the case that the normals are linearly dependent, in which case we either have no solutions when $d_{1} \ne d_{2}$, or infinitely many solutions when $d_{1} = d_{2}$, which is the case when the planes are identical.

Let's consider what happens in $P^{3}$: in case the planes are not parallel, they will intersect over a line, which is the same line they intersect over in $R^{3}$ under a perspective shift (we will define this term more rigorously in a bit). Let us consider the case where they are parallel. In that case, the planes share the same line at infinity by construction - meaning they still intersect over a line! Perhaps a less arbitrary way to think of this is to consider all the points at infinity added to each plane when constructing its projective extension: consider the plane $\pi_{1}$. each equivalance class of parallel lines $[l]$ in $\pi_{1}$ is associated with a point at infinity $P_{[l]}$. Now, consider a plane $\pi_{2}$ parallel to $\pi_{1}$. Clearly we can identify a line $l'$ in $\pi_{2}$ for every line $l$ in $\pi_{1}$ such that $l'$ is parallel to $l$, meaning it also shares a point at infinity with $l$. Since we wish to associate each line with a single point at infinity (otherwise we would violate the linear space axioms as we've already seen when discussing $P^2$). Since this argument holds for all lines on $\pi_{1}$, we can say that the planes share the same line at infinity.

I'd like to pause here and think about the beauty and simplicity of incidence relations in projective spaces: whereas in Euclidean geometry, we often need to treat parallel lines separately and exclude them from our theorems, in projective geometry we see that parallel lines don't seem particularly special. Indeed, theorems which don't hold for parallel lines in Euclidean spaces, hold for all lines in projective spaces. There is still the somewhat peculiar nature of the points at infinity, but as we will soon see they too are just regular lines when looking at them from the right perspective.

Let's show that $P^{3}$ is a linear space:

1. Consider two distinct points $p_{1},p_{2} \in P^{3}$. 
    1. If they're both in $R^{3}$ then by Euclid there is a single straight line passing through both points. 
    2. If they're both not in $R^{3}$, we know that they are both points at infinity of two distnct lines $l_{1}, l_{2}$ in $R^{3}$. If $l_{1}, l_{2}$ lie in the same plane then we know that $p_{1}, p_{2}$ both lie on the same line at infinity and we are done. If they don't lie on the same plane, let $p$ be some point on $l_{2}$. Now, by Playfair's, there exists a single line through $p$ parallel to $l_{1}$, let's denote it by $l_{1}'$. Consider the span of $l_{1}', l_{2}$. Clearly the lines intersect and thus are coplanar and span some plan $\pi$. The plane $\pi$ has some line at infinity $l_{[\pi]}$ by our construction of $P^{3}$, thus the point at infinity $p_{1}'$ of $l_{1}'$ and $p_{2}$ are both incident with $l_{[\pi]}$. However, since, $l_{1}$ and $l_{1}'$ are parallel, we have $p_{1}=p_{1}'$, and we are done.
    3. w.l.o.g, $p_{1} \in R^{3}$ and $p_{2} \notin R^{3}$, so $p_{2}$ is the point at infinity for some equivalance class of parallel lines $[l]$. By Plairfair's we can construct a line $l$ through $p_{1}$ such that $l\in [l]$, however this means that $l$ is also incident with $p_{2}$, satisfying the axiom.
2. Consider a line $l$ in $P^{3}$: since $l$ is on $P^{3}$, it is either a line at infinity of some plane, in which case we follow the same proof as the 2 dimensional case, or a line in $R^{3}$, which is already a linear space, satisfying the axiom.

Thus proving that $P^{3}$ is a linear space. Note that this isn't a complete proof since we haven't dwelled on the uniqueness on the incidences but rather hand-waved them, however it is pretty straightforward to extend the ideas presented to also show uniqueness. 

### Incidence Relations in P(3, R)

Consider two distinct lines $l_{1}, l_{2} \in P^{3}$:

1. If they're both in $R^{3}$ and not parallel nor skew, then by the parallel postulate we know that they intersect at a single point. If they are parallel, then by construction we have a point at infinity $p_{[l]}$ in $P^{3}$ incident with both, and only that point. However, if they are skew, then they span no plane thus have no mutual projective plane extension nor do they belong to the same equivalance class and thus share the same point at infinity, so skew lines still *do not intersect in P^{3}*$.

2. If they're both not in $R^{3}$, we know both are lines at inifnity of two non-parallel planes $\pi_{1}, \pi_{2}$ in $P^{3}$. If the planes are non-parallel, then we know they intersect over a shared line $l$ in $R^{3}$. Consider the point at infinity $p_{[l]}$ of $l$. $l \in \pi_{1}$, and so $p_{[l]} \in l_{1}$. By the same argument, $p_{[l]} \in l_{2}$, thus $p_{[l]}$ is the single point incident with both lines.

3. w.l.o.g, $l_{1} \in R^{3}$ and $l_{2} \notin R^{3}$ and is the line at infinity of some plane $\pi$. Let $p$ by a point on $\pi$. Again by Playfair we know that there exists a unique line $l_{1}'$ through $p$ parallel to $l_{1}$, and by our construction it is incident with a point at inifnity $p_{l_{1}} \in l_{2}$, which is also incident with $l_{1}$ by our construction since $l_{1}$ and $l_{1}'$ are parallel, so we have $l_{1}$ and $l_{2}$ interesecting at a single point $p_{l_{1}}$.

Thus any two non skew lines in $P^{3}$ are incident at a point.

### Perspective Drawing Revisited

Now that we have presented the projective space, we can go back to our perspective drawings and explain them in terms of $P^{3}$ (with the limitation of lines parallel to the picture plane appearing to not intersect the horizon line).

#### Railway Track

In our drawings, we represented the railway track as a two dimensional object. The track is bounded by two sets of two parallel lines in a rectengular setup in $R^{3}$, all coplanar. We drew the track under three different perspectives:

1. Top-down view - the plane in which the track lies is parallel to the image plane, thus the track is represented as a rectangle in our drawing because all lines are parallel to the image plane. However, in $P^{3}$, the edges do in fact still intersect at a point at infinity.

2. One-point perspective view - the image plane is perpendicular to the track and parallel to the ties. The sides are parallel and thus meet at a point at infinity which we called a vanishing point, which is incident with the line at infinity, represented by the horizon line. The horizon line is the line at infinity of the projective extension of the plane in which the track lies.

3. Two-point perspective view - the image plane is perpendicular to the track but none of the lines represnting it are parallel to the image plane and thus we see all the relevant points at infinity. Since all lines lie on the same plane, all points at infinity are incident with the same line at infinity, which is the horizon line.

### Cube

The cube is a 3-dimesional object consisting of 3 pairs of parallel rectengular faces, perpendicular to each other. Indeed, another way to define a cube is by the area bound by the intersection of 3 pairs of parallel, equally spaced planes, with all sets perpendicular to each other. Let us interpret this in terms of $P^{3}$: we have three equivalent classes $[\pi_{1}], [\pi_{2}], [\pi_{3}]$, and their projective extensions add three distinct lines at infinity $l_{[\pi_{1}]}$, $l_{[\pi_{2}]}$, $l_{[\pi_{3}]}$. Note that each edge $e$ of the cube is the intersection of two planes $\pi_{i}, \pi_{j}$ and thus the point at infinity of the edge $p_{[e]}$ is also the intersection of the lines at infinity $l_{[\pi_{i}]}, l_{[\pi_{j}]}$. In the three-point perspective view of the cube, we can indeed spot all these lines at infinity and see that they intersect at points of infinity incident with the mutual edges of the planes of the cube:

![Three-point perspective view of a cube, revisited](images/3_point_persp_revisited.png)

In the two point perspective drawing, we identify two vanishing points. This is because in a two-point perspective, one of the axes of orientation (one of the set of parallel edges) of the cube is perpendicular to the picture plane, and we've already established that perspective drawing does not capture the intersection of such lines in a projective space. The other two vanishing points definite a line at infinity, and are also incident with the other two lines at infinity, however since we cannot identify the third vanishing point we also cannot identify the other two lines at infinity.

![Two-point perspective view of a cube, revisited](images/2_point_persp_revisited.png)

Finally, in the one-point perspective drawing we only identify one vanishing point because two principal axes of the cube are parallel to the picture plane, and thus we can only identify the point at infinity of one set of parallel edges. However, we can still identify the line at infinity by taking into account that it will be parallel to the picture plane and thus parallel to a non-intersecting set of parallel edges, which we can identify by inspecting a face that does have a pair of parallel edges which coincide with the vanishing point:

![One-point perspective view of a cube, revisited](images/1_point_persp_revisited.png)

### The Shadow of a Triangle

Consider this perspective drawing, representing a lamp post lighting a sign board made of glass containing a triangle:

![Shadow of a triangle puzzle](images/xx_shadow_puzzle.png)

You're told that the both the bottom of the lamp post and the bottom edge of the sign board lie on the ground, and that the lamp post and one of the edges of the board, w.l.o.g $cf$, are coplanar. The lamp is shining light at the sign board. We are interested in finding out the shadow of the circle, as viewed from the perspective of the viewer. This is a perspective geometry puzzle. Solving it will lay the foundation for proving a fundemental theorem in projective geometry which we will later use to define a *perspective* or a *perspectivity* in a more mathematical sense.

How do we solve this puzzle? Essentially what we're looking for is the intersection of the ray of light from the lamp post to the each vertex of the triangle with the ground plane. These points will be the extreme points of a polygon which encloses the shadow of the triangle (this is an application of the geometerical optics model), so determining where the ground plane is would be a good start. Since we know that the bottom of the lamp post is on the ground plane, as well as the bottom edge of the board, we have 3 points which are not all collinear that lie on the same plane. Since 3 points, not all collinear, define a plane, we can determine the ground plane. Let's do this by connecting the line from the bottom of the post to the vertice at the ends of the bottom edge of the board.

![Finding the ground plane](images/shadow_puzzle_ground_plane.png)

These lines span the ground plane. Now, let's first find the shadow of the sign board. We can do this by connecting the lamp post $a$ with the edges of the board $\square_{cdef}$, and finding the points of intersection with the ground plane spanned by $\vec{be},\vec{bf}$. However, since $ab$ and $cf$ and coplanar, we know that $ac$ and $bf$ are also coplanar, and thus by the parallel postulate they must interesect at some point along the continuation of $bf$, let's denote this point as $c'$. Notice that $c'$ lies on the ground plane, thus it is the shadow of $c$ cast by the lamp $a$. By the same argument, $ab$ and $de$ are also coplanar since $cf$ and $de$ are parallel, and thus interesect at some point $d'$ along $be$, which is the shadow of $d$. Finally, $f$ and $e$ already lie on the ground plane, and thus they are they are fixed points of the shadow since they will always be the point of intersection of a light ray through them and the ground plane. Thus, the shadow of the sign board is the polygon $\square_{c'd'ef}$:

![Sign board shadow](images/sign_board_shadow.png)

Now, consider the edges of the triangle $\triangle_{ghi}$. Since the triangle lies on the plane determined by the sign board, and since we are in $P^{3}$ we know that all lines in a plane are incident at some point, meaning that the edges of the triangle interesect with the edges of the board, either at a point in $R^{3}$ or at a point at infinity. Let us extend the edge $ig$, and denote its point of intersection with $fc$ and $cd$ as $i'$ and $g'$ accordingly. In our drawing, the lines clearly intersect, however were the edge of the triangle parallel to these edges of the board we would still have at intersection at a point at infinity. That is to say, the method we follow here will always hold in $P^{3}$, regardless of the shape, orientation and position of the triangle. Now, we wish to find the shadow of $g'$ and $i'$. Since $i'$ lies in $fc$ which lies on the ground plane, $i'$ remains fixed. Now, since $g'$ is incident with $cd$, we know that the light ray takes it to a point on the shadow of $cd$, which is $c'd'$. Denote this point as $g''$:

![Shadow of i'g'](images/shadow_of_ig.png)

By using the same construction with the triangle edge $gh$, we get the shadow of the line $gh'$, denoted as $g_{s}h$. We know that the point $g$ will be taken to a point along the shadow of $i'g$, so the find $g_{s}$ we need to draw a line from $a$ through $g$ and find its point of intersection with $i'g''$':

![Shadow of h'g_s and g_s](images/shadow_of_g.png)

By the same argument, we can find the shadow of $i$, denoted as $i_{s}$ - we cast a ray through $i$ and denote its intersection with $i'g''$ as $i_{s}$. The only vertex of the triangle whose shadow we still haven't determined is $h$. We can find it by extedning $ih$ and denoting its point of intersection with the ground plane (and the extended line of $fe$) as $h'$. Now, we know that $ih$ is taken to a $i_{s}h'$, and we know that $h$ is the intersection of $ih'$ and $h'g$, so we can identify $h_{s}$ as the intersection of $i_{s}h'$ and $h'g_{s}$:

![Shadow of h](images/shadow_of_h.png)

If we follow the ray model proposed by geometerical optics, clearly $\triangle_{g_{s}h_{s}i_{s}}$ is the shadow of the $\triangle_{ghi}$ cast by the lamp positioned at point $a$, viewed from the perspective from which the image is drawn. 

## Desargues' Theorem

Observe that each vertex and its shadow define a straight line which is also incident with the point $a$. We say that the triangles are *in perspective from a point*, and we call $a$ the *center of perspecivity*. Also, and perhaps less intuitively, if we extend the respective edges of the two triangles, we will notice that they intersect at three collinear points. When we have two triangles such that the intersection of the extension of their edges are collinear, we say that they are *in perspective from a line*, and we call the line passing through these points the *axis of perspectivity*. In the case of our shadow drawing puzzle, the axis of perspectivity is the line passing through $fe$, which is also the intersection of the planes on which the triangles lie.

Desargues' theorem is a theorem in projective geometry which states that *two triangles are in perspective from a point iff they ae in perspective from a line*. The theorem holds for any projective space and also holds for the projective plane as we have constructed it but in general only holds for planes which are [Desarguesian](https://en.wikipedia.org/wiki/Projective_plane#Desarguesian). Since we built our projective planes in Euclidean space from Euclidean planes, we needn't worry about this and can in fact prove the theorem geometrically in the two-dimensional case, however it is easier to prove the theorem in the three-dimensional case. In fact, we have provided a sketch of a proof in the previous section.

### Three-Dimensional Case

Consider two non-coplanar triangles $\triangle_{ABC}$ and $\triangle_{abc}$ in $P^{3}$. which are in perspective from a point $P$. Denote the plane $\triangle_{ABC}$ lies on as $\pi_{1}$ and the plane $\triangle_{abc}$ lies on as $\pi_{2}$. Since we are in $P^{3}$, $\pi_{1}$ and $\pi_{2}$ interesect over a line $l$.

Consider the lines $AB$ and $ab$. Since they are in perspective from a point, they are coplanar on some projective plane, and thus are incident at some point $P_{AB}$. However, since $AB$ and $ab$ also lie on $\pi_{1}$, $\pi_{2}$ repsectively, we know that $P_{AB}$ lies on $l$. Similarly, $BC$ and $bc$ are also co-planar due to the triangles being in perspective and interesect at some point $P_{BC}$ on $l$. Finally, $AC$ and $ac$ will also intersect at some point $P_{AC}$ along $l$. $P_{AB}$, $P_{BC}$ and $P_{AC}$ all lie on $l$, thus $\triangle_{ABC}$ and $\triangle_{abc}$ are in perspective from a line with the axis of perspectivity being the line of intersection between $\pi_{1}$ and $\pi_{2}$.

![Desargues' theorem](images/desargues_theorem.png)

Consider the inverse: let $\triangle_{ABC}$ and $\triangle_{abc}$ be non-coplanar lying on $\pi_{1}$ and $\pi_{2}$ repsectively be in perspective from the line $l$ which is the intersection of $\pi_{1}$ and $\pi_{2}$. It is trivial to show that in this setup, the respective edges are also distinct and coplanar and thus span a plane. In total, we have three planes associated with each respective pair of edges $\pi_{AB}$, $\pi_{BC}$ and $\pi_{AC}$. Since we are in $P^{3}$, every pair of planes intersect over some line $l$, so we have $\pi_{AB}$ and $\pi_{BC}$ intersecting over $l_{1}$ and $\pi_{AB}$ and $\pi_{AC}$ intersecting over $l_{2}$. Again since we are in $P^{3}$, we have $l_{1}$ and $l_{2}$ incident at a single point $P$. Since $P$ is incident with both $l_{1}$ and $l_{2}$, it is also incident with all three planes, and thus is the point of intersection of all three planes. Consider the geometrical meaning of the intersection of each pair of planes: since the planes were constructed from two non-coplnar triangles, we have $\pi_{AB}$ and $\pi_{AC}$ both sharing the same line $Aa$, meaning $l_{2}$ is in fact $Aa$. Similarly, we can show that $Bb$ and $Cc$ are also lines of intersection of the other possible plane combinations. This means that $P$ is the intersection of $Aa$, $Bb$ and $Cc$, which by definition makes the triangles in perspective from the point $P$, proving the inverse.

### Two-Dimensional Case

The two-dimensional case is more involved. We will use a proof which relies on being able to "lift" the triangles to 3D space. Note that this proof relies on the projective plane being embedded in a three-dimensional projective space, which is not always the case in more abstract or discrete cases. The idea behind lifting is to lift one corresponding vertex of each triangle off the plane in which both triangles reside, making sure the lifted vertices remain in perspective from the same point/line as the co-planar setup (depending on the direction of the proof we wish to prove), then using Desargues' theorem in 3D which we have already proven to find an axis/point of perspectivity for the lifted triangles, then project it back to the plane. Here's an illustration of the process of lifting two coplanar triangles through some point in space $P$:

![Lifting coplanar triangles](images/desargues_2d_lift.png)

Notice that $\triangle_{ABC}$ and $\triangle_{abc}$ are coplanar, yet via lifting the points $A$ and $a$ the triangles $\triangle_{A'BC}$ and $\triangle{a'bc}$ are not coplanar, and thus are in perspective from a line by our proof for the 3D case. It can be shwon that the original triangles $\triangle_{ABC}$ and $\triangle_{abc}$ are in perspective from the same line. We will not provide a proof for the coplanar case.

### In Perspective Drawing

Recall our perspective drawing of a tiled floor. The initial configuration is this:

![initial quadrilateral](images/xx_tiled_floor_initial.png)

We then extended the edges $AC$ and $BD$ and denoted their meet as $Y$ and the edges $AB$ and $CD$ and denoted their meet as $X$. We then considered the line passing through $XY$ and declared it a representation of the line at infinity due to the fact that the initial parallelogram repesents a square in $R^{3}$. To find the next tiles, we extended the diagonal $AD$ until it intersected with $XY$ at some point $P$:

![Tiled floor with horizion line](images/xx_tiled_floor_xpy.png)

We then reasoned that since the tiled floor consists of rows of aligned squares, the lines $CP$ and $BP$ are also diagonals of the neighboring tiles and thus parallel to $AD$ in $R^{3}$ so they must also meet $XY$ at $P$, marking their intersection with $BY$ and $CX$ as $B'$ and $C'$, respectively. Finally, we used these points to find the last remaining points of the neighboring tiles:

![Neighbors of initial tile found](images/xx_tiled_floor_neighbors.png)

We can repeat the last few steps to tile the rest of the floor

![Tiled floor](images/xx_tiled_floor_final.png)

We can employ Desargues' theorem to better understand the incidence relations represented by the drawing. Notice, for example, that $\triangle_{ABC}$ and $\triangle_{DB'C'}$ are in perspective from the point $P$, meaning they are also in perspective from some line, and indeed we identify that they are in-perspective from the line $XY$. Consider the triangles $\triangle_{C'LC}$ and $\triangle_{DCA}$. Clearly they are in perspective from the line $XY$ and thus must be in perspective from some point, and indeed we can identify that they are in perspetive from the point $Y$. Indeed, Desargues' theorem is a powerful tool in understanding the incidence relations of objects in a projective space.

## Perspectivities

We would like to extend the concept of being "in perspective from a point" beyond triangles. Consider two planes $\pi$, $\pi'$ in $P^3$ and some point $O$ not incident on either plane. A map $T: \pi \to \pi'$ is called a **perspectivity centered at $O$** if $\forall x \in \pi: $ $x, T(x)$ and $O$ are collinear. 

Consider the lamp post drawing from earlier, this drawing models the shadow of $\pi'$ on $\pi$ by the ray model formed by a light source. We've seen that the triangles are in perspective from the point $a$, but does this drawing also describe a perspectivity map? In other words, do all lines from $a$ through $\pi'$ intersect $\pi$ at some point? The answer, as we soon shall see, is yes. For now, let's look at a few more examples.

Consider the camera-obscura setup we presented in our discussion of geometrical optics. We used the setup to model the core underlying prinicple of a camera, taking the tree from the projected space, henceforth *domain* space and projecting it to the image plane. In our construction, we used lines passing through the tiny hole in the box, then continuing to hit the image plane. Clearly, by our definition of a perspectivity, this setup is a perspectivity centered at the hole. Whereas in the previous example we've seen a projectivity whose center which lies on the same side of both planes, in this example we see a projectivity cenetered at a point which lies in the halfspace between the two planes, and we interpreted the result as the image formed by a camera. Notice how in this can the orientation of the domain plane is inverted when projected to the image plane.

Let us consider one last example. Consider the following setup:

![Viewing a triangle on the ground plane](images/eye_viewing_triangle.png)

This setup is almost identical to the lamp post setup, but instead of a lamp we have an eye and instead of a tirangle on the sign board we have a triangle on the ground. We use the eye as the center of perspectivity but now we use the ground plane as the domain plane and the sign board as the image plane. By sending rays from the eye toward the vertices of the triangle on the ground plane, we can identify that the rays interesect the image plane, forming the image of the triangle. We can interpret this as the image formed by the eye when looking in the direction of the image plane.

We see that perspectivity maps can be interpreted as shadows and as images formed by the camera or the eye. Be cautious though - these interpretations still do not capture the full essence of a projective space - we cannot properly view points or lines at infinity at either plane, only their images under perspecitivites that map them to points and lines in real Euclidean space.

### Perspectivities are well-defined

For a map $T$ to be well-defined, the map must be unique for each point in its domain, meaning that if two ordered pairs $(x, y_{1})$ and $(x, y_{2})$ are on the graph of $T$, then $y_{1}=y_{2}$.  We wish to show that perspectivities are well-defined. The geometric interpreation of this is that if we have a perspecivity $T$ centered at $O$ from $\pi$ to $\pi'$, then for every point $x \in \pi$, the line through $O$ and $x$ intersects $\pi'$ at a unique point $T(x)$.

Consider $T$ be a perspectivity centered at $O$ from $\pi$ to $\pi'$, where the planes are distinct and $O$ is not contained in either plane. Let $x$ be a point in $\pi$. Recall that we are interested in discussing perspectivities in $P^{3}$. To prove that $T$ is well-defined, we will use the following lema: let $\pi$ be a plane and let $l$ be a line not on $\pi$, in $P^{3}$. $l$ and $\pi$ are incident at a unique point. Now, let $\pi$, $\pi'$ be two planes in $P^{3}$ and let $O$ be some point not on either plane. Let $X$ be some point on $\pi$. Clearly $OX$ does not lie on $\pi'$, thus by the lema the line through $OX$ is incident with $\pi'$ at exactly one point $T(X)$. Thus, $T$ is well-defined, and is bijective.

To prove the lema, let's consider each case. $l$ can either be a line from $R^{3}$ or a line at infinity, and the planes can either be in $R^{3}$ or the plane at infinity, however if $l$ is the line at infinity then it lies on the plane at infinity by construction of $P^{3}$, so we only have three cases:

1. $l$ is a line in $R^{3}$ and neither of the plane is the plane at infinity. In this case, we can use the result from $R^{3}$ that a line in $R^{3}$ is either incident with a plane at a unique point, or parallel to the plane. However, if $l$ is parallel to the plane, then there exists a line $l_{\pi}$ on $\pi$ such that $l$ and $l_{\pi}$ are parallel, and thus incident at a unique point at infinity. Thus, $l$ is incident with $\pi$ at a unique point.
2. $l$ is a line in $R^{3}$ and one of the planes is the plane at infinity. Since $l$ is a line in $R^{3}$, we declare it incident with a point at infinity $p_{[l]}$. Since the plane at infinity consists of all lines at infinity, we know that $l$ and $\pi_{\infty}$ are incident at $p_{[l]}$. For the plane not at infinity, we use the same argument as in the previous case.
3. $l$ is a line at infinity and both planes are not the plane at infinity. Since we know that $l$ does not belong to either plane,  we know that $l$ is not the line at infinity of either plane, however by construction of $P^{3}$ we know that $l$ is the line at infinity of some plane $\pi_{l}$. In our previous discussion of $P^{3}$, we proved that every two planes in $P^{3}$ intersect over a line. Let's denote the intersection of $\pi$ and $\pi_{l}$ as $l_{1}$. Since $l_{1}$ is a line in $P^{3}$, it is incident with a point at infinity $p_{l_{1}}$. Since $l_{1}$ lies in $\pi_{l}$, we know that $p_{l_{1}}$ is incident with the line at infinity of $\pi_{l}$, which is $l$. Thus, $l$ is incident with $\pi$ at a unique point $p_{l_{1}}$. An identical argument can be used for $\pi'$.

Thus, we have proven that perspectivities are well-defined, and are bijective.

### Perspectivities centered at infinity

We have shown that perspective maps are defined in $P^{3}$. This means that perspectivities can either be centered at a point in $R^{3}$ or at a point at infinity. If the center of perspectivity is a point at infinity, then by construction all lines incident with it must be parallel to each other, thus a perspectivity centered at infinity looks like this (the dotted lines represent that the lines meet at a shared point at infinity):

![Parallel perspectivity](images/parallel_perspectivity.png)

Such perspectivity is called a *parallel perspectivity*. By examining the drawing we can observe that such perspectivity seems to preserve angles and distances, unlike perspectivities centered at a point in $R^{3}$, which are called *centeral perspectivities*.

## Projectivities

In the beginning of this journey we set out to explore the properties of perspective shifts. So far, perspectivity maps in $P^{3}$ are the most promising framework we have presented to discuss perspective shifts. However, in order to be able to discuss the properties that change under perspective shifts, we need to have a framework that lets us relate between different perspectives. Consider the following example of two viewers looking at the same railway track from different positions (note - the drawing wasn't carefully constructed so it is not perspectively accurate and meant only for illustrative purposes):

![Two viewers looking at the same railway track](images/railway_track_two_viewers.png)

We have two perspectivities centered at two different, non co-planar points, mapping the same domain plane to two different image planes. We would like to be able to discuss the relation between these planes. One way to do this would be to relate to define a map from one image plane to the other and analyze it. We've seen how perspective maps can be used to represent a perspective view of a plane, so perhaps it would be nice to be able to relate the two image planes via a perspective. Let's attempt to introduce a perspectivity from $\pi'$ to $\pi''$, centered at some point $P$. Consider a line $l$ in the original domain plane. The line is taken to $l'$ in $\pi'$ and to $l''$ in $\pi''$. We would be interested in a perspectivity that takes $l'$ to $l''$. Let us also consider another point $X$ in $\pi$ not on $l$, taken to $X'$ in $\pi'$ and $X''$ in $\pi''$. Through any two points on the line $l$ and the point $X$ we can create a triangle in $\pi$, which will be taken to a triangle in $\pi'$ and in $\pi''$. Our perspectivity centered at $P$ should take the triangle from $\pi'$ to $\pi''$, meaning the triangle should be in perspective from the point $P$. By Desargues' these triangles are also in perspective from a line. In particular, $l''$ and $l'$ should meet at some point on the axis of perspectivity defined by the perspective map. Consider however the case where $l'$ and $l''$ are skew lines. In this case, they do not meet, thus they are not in perspective from a line, contradicting our assumption that there exists a perspectivity map from $\pi'$ to $\pi''$, which is rather unfortunate.

However, not all hope is lost. Consider that the maps $T_{1}: \pi \to \pi'$ and $T_{2}: \pi \to \pi''$ are bijective, thus there exists a well-defined map $T^{-1}_{1}: \pi' \to \pi$. Since the maps are well-defined, we can compose them and get a new map $T_{2} \circ T^{-1}_{1} : \pi' \to \pi''$. Going back to our intuitive discussion of perspectivities, this can be thought of as looking at the shadow of $\pi'$ on $\pi$ (this is the inverse of $T_{1}$) from the center of perspectivity of $T_{2}$ (which takes $\pi'$ to $\pi''$). We call a composition of perspective maps a *projectivity*, or a *homography*. We define a projectivity as a bijection $\pi \to \pi'$ in $P^{3}$ if it can be constructed as a composition of a finite number of perspective maps. As we will soon see, projectivities capture all perspective shifts as well as isometries and affine transformations. For example, we can construct an identity projectivity $\pi \to \pi$ by taking any perspectivity $T: \pi \to \pi'$ and composing it with its inverse.

In the next few sections, we will look at a few examples to develop an intuition for projectivities, and attempt to derive a few useful theorems which would help us understand their nature.

### 1D Projectivities

In the previous section we've seen an example of a projectivity between planes. This is a two-dimensional projectivity. To understand projectivities between planes, we must first examine the one dimensional case - projectivities between lines. 

Let $l$ and $l'$ be two distinct lines in $P^{3}$. Let $A$, $B$ be two distinct points on $l$ and $A', B'$ be two distinct points on $l'$. Can we always construct a projectivity $T: l \to l'$ such that $T(A)=A'$ and $T(B)=B'$? Well, if $l$ and $l'$ are not skew, we can construct a plane through $l$ and $l'$ and then consider the lines through $AA'$ and $BB'$. Since the lines are coplanar in $P^{3}$, they must intersect at a single point $O$. We can draw a line from any point on $l$ to $O$, and since the line and $l'$ are coplanar they are bound to intersect at a unique point. Thus we have constructed a projectivity from $l$ to $l'$ by using a single perspectivity centered at $O$. When the lines are skew, things become more interesting.

In the previous section, we have proven that there is no perspectivity from $l$ to $l'$ if they are skew lines in a projective space. However, by chaining perspectivities, we can create a projectivity that does exactly that. Now we no longer assume $l$ and $l'$ are coplanar, meaning $AA'$ and $BB'$ do not necessarily meet. However, we can still connect any two points by a straight line. Recall also that two non-skew lines are coplanar. Consider the following construction:

![Construction of a projectivity defined by two points on two non-coplanar lines](images/1d_projectivity_ab.png)

1. Connect $A$ to $B'$ via a line, denoted $m$.
2. $m$ and $l$ are incident on $A$ and thus coplanar.
3. $m$ and $l'$ are incident on $B'$ and thus coplanar.
4. Construct a perspectivity taking $A, B$ on $l$ to $A, B'$ on $m$. Since  $m, l$ are coplanar there exists such perspectivity. Note that this perspectivity fixes $A$. Denote this perspectivity $\Gamma_{1}$.
5. Similarly, construct a perspectivity taking $A', B'$ on $m$ to $A, B'$ on $l'$. Such perspectivity exists by the same argument, and fixes $B'$. Denote it by $\Gamma_{2}$.
6. Consider the composition $T=\Gamma_{2} \circ \Gamma_{1}$:
$$
\begin{gathered}
T(A)=\Gamma_{2}(\Gamma_{1}(A))=\Gamma_{2}(A)=A'
\\
T(B)=\Gamma_{2}(\Gamma_{1}(B))=\Gamma_{2}(B')=B'
\end{gathered}
$$

Clearly, this construction satisfies our requirement.

Now, consider sets of three points $A, B, C$ on $l$ and $A', B', C'$ on $l'$. Can we construct a projectivity from $l$ to $l'$? Let's start with the case where $l$ and $l'$ are coplanar. We can't use the same construction as before, since there is no guarantee that $AA'$, $BB'$ and $CC'$ are all incident at the same point. Instead, consider the following construction, illustrated here:

![criss-cross constrution](images/criss_cross_construction.png)

1. Connect $A$ to $B'$ and $B$ to $A'$. The two lines are coplanar and so must interesect at some point, denoted $P_{AB}$.
2. Connect $B$ to $C'$ and $C$ to $B'$. Again, they must intersect at some point $P_{BC}$.
3. Connect $B$ to $B'$.
4. Connect $P_{AB}$ to $P_{BC}$ with a line, denoted $m_{B}$. Since $m_{B}$ and $BB'$ are coplanar, $m$ and the line through $BB'$ are incident at some point $P_{BB}$.
5. Consider the perspectivity $\Gamma_{B'}: l \to m_{B}$ centered at $B'$. It sends $A$ to $P_{AB}$, $B$ to $P_{BB}$ and $C$ to $P_{BC}$.
6. Consider the perspectivity $\Gamma_{B}: m_{B} \to l'$ centered at $B$. It sends $P_{AB}$ to $A'$, $P_{BB}$ to $B'$ and $P_{BC}$ to $C'$.
7. Consider the projectivity $T=\Gamma_{B} \circ \Gamma_{B'}$. It sends $A$ to $A'$, $B$ to $B'$ and $C$ to $C'$, satisfying our requirement.

We call this a *criss-cross construction* around $B$. Now, consider the case where $l$ and $l'$ are not necessarily coplanar. One construction of the desired projectivity is as follows:

1. Connect $A$ to $C'$ via a line, denoted $m$.
2. Denote a point along $m$ as $K$.
3. $m$ and $l'$ are incident at $C'$ and thus coplanar. Consider the points $A', B', C'$ on $l'$ and the points $A, K, C'$ on $m$. We can create a projectivity $l \to l'$ such that it takes $A', B', C'$ to $A, K, C'$ via the construction we've shown for the coplanar case. This involves composing two perspectivities.
4. $l$ and $m$ are incident at $A$ and thus coplanar. Consider $A, K, C'$ on $m$ and $A, B, C$ on $l$. Again we can use the construction presented before to finish the projectivity.

In total, we needed 4 perspectivities. Can we do better? We know that the lower bound is at least 2 perspectivities in the non-coplanar case. Consider the following construction, illustrated here:

![mapping A to A' B to B' C to C'](images/1d_projectivity_abc.png)

1. Connect $A$ to $C'$ via a line, denoted $m$.
2. Connect $A$ to $A'$ via a line, denoted $k$.
3. Denote a point along $k$ as $P$.
4. Connect $C'$ to $P$.
5. Connect $B'$ to $P$.
6. Note that $B'P$ and $m$ are coplanar, meaning $B'P$ intersects $m$ at some point $B''$.
7. Consider the perspectivity centered at $P$ from $l'$ to $m$: it takes $A'$ to $A$, $B'$ to $B''$ and $C'$ to $C'$.
8. Connect $B''$ to $B$.
9. Connect $C'$ to $C$. Since $l$ and $m$ are coplanar, we know that the lines $B''B$ and $C'C$ intersect at some point $O$.
10. Connect $A$ to $O$.
11. Consider the perspectivity centered at $O$ from $m$ to $l$: it takes $A$ to $A$, $B''$ to $B$ and $C'$ to $C$.
12. By composing the perspectivity from (7) with the perspectivity from (11), we get the desired projectivity. Note that this is minimal amount of perspectivities needed to form the projectivity.

We have shown two projectivities from $l'$ to $l$ taking $A', B', C'$ to $A, B, C$. A question that should come to mind is whether the two projectivities are, in fact, identical: Given a point $K'$ on $l'$, do both projectivities take $K'$ to the same point $K$ on $l$?

## Three Fixed Point Theorem

A fixed point is a point that remains the same under a map. For example, in linear maps (linear transformations), the origin is a fixed point. We have seen perspetivities and projectivities that fix some points, and tried to point them out whenever they show up. The amount of fixed points under a projectivity is intimately tied to the nature of the projectivity. In fact, the following statement, which we will refer to as the three fixed point theorem, is true:

*Let $T: l \to l$ be a projectivity such that there exists three distinct points $A, B, C$ on $l$ such that $T(A)=A, T(B)=B, T(C)=C$ (in other words - $T$ fixes three points), then $T$ is the identity map on $l$l.*

We will provide one proof for this theorem, which relies on a isomorphism between 1D projectivities and mobius trasformations (which are a linear fractional transformation over the complex field), which we will prove later when discussing the matrix group which desribes projections, the projective linear group.

Recall that a mobius transform is a transformation over the complex field $\mathbb{C}$ defined as:

$$
f(z) = \frac{az+b}{cz+d}
$$

Where $a, b, c, d$ are all taken from $\mathbb{C}$ and $z$ is a complex argument. Consider the complex derivative of $f$:

$$
f'(z)=\frac{a(cz+d)-c(az+b)}{(cz+d)^{2}}=\frac{ad-cb}{(cz+d)^{2}}
$$

When $ad-cb=0$, we get $f'(z)=0$ and so we know that $f(z)=z_{0}$ with some constant value $z_{0} \in \mathbb{C}$. This is a pathological case and would make $f(z)$ non-bijective so we also add the constraint that $ad-cb \ne 0$.

A point $z_{0}$ is fixed under $f(z)$ if $f(z_{0})=z_{0}$. Let's write the relation explicitly:
$$
\begin{gathered}
z_{0} = \frac{az_{0}+b}{cz_{0}+d} \\
cz_{0}^{2} + dz_{0} = az_{0} + b \\
cz_{0}^2 + (d-a)z_{0} - b = 0
\end{gathered}
$$

If $c \ne 0$, this is a second degree polynomial, meaning there are at most two solutions, meaning two fixed points. If $c = 0$ and $d-a \ne 0$, this is a first degree polynomial, meaning there is a single fixed point. If however, $c=0$ and $d-a=0$ we get $-b=0$, which has infinitely many solutions iff $b=0$, otherwise there are no solutions. Thus if we have a homography from a plane to itself which fixes three points, it fixes every point, and thus is the identity transform. 

It is interesting to note that there are only 3 constraints on the 4 complex numbers that define the mobius transform, which means that there is still 1 degree of freedom. All transforms that maintain $c=b=0$ and $a=d$ are identity transforms, so $a=d$ can be any complex number. This is not surprising if we consider the mobius transform $f_{1}(z)$ with coefficients $a, b, c, d$ and another transform $f_{2}(z)$ with coefficients $\alpha a, \alpha b, \alpha c, \alpha d$:

$$
\begin{gathered}
f_{2}(z) = \frac{\alpha a z + \alpha b}{\alpha cz + \alpha d} = \frac{\alpha(az+b)}{\alpha(cz+d)}=\frac{az+b}{cz+d}=f_{1}(z)
\end{gathered}
$$

Consider a $2 \times 2$ square matrix $A$ over the complex field:

$$
A = \begin{pmatrix} a & b \\ c & d \end{pmatrix}
$$

We can define an isomorphism from $A$ to a mobius transform. We can now rewrite our restriction $ad-bc \neq 0$ as $\text{det}A = 0$, meaning that $A$ must be invertible and thus belong to the [general linear group](https://en.wikipedia.org/wiki/General_linear_group) $GL(2, \mathbb{C})$. We have shown that for any two matrices $A, \alpha A$, we get the same mobius transform, so in order to ensure that for any two matrices from the domain group we get two distinct mobius transforms, we can instead choose $A$ from the quotient group

$$
GL(2, \mathbb{C})/Z(2, \mathbb{C})
$$

Where $Z(2, \mathbb{C})$ is the group of all nonzero scalar transformations of $\mathbb{C}$. This group is called the [projective linear group](https://en.wikipedia.org/wiki/Projective_linear_group) $PGL(2, \mathbb{C})$, and we will soon see why that is the case.

We can then define an equivalance relation $A \sim \lambda A$  where $\lambda \ne 0$, and use the member of the equivalance class $[A]$ from the quotient group we've just defined as its represntative for mobius transforms. We will revisit mobius transforms in a different post discussing stereographic projections.

## Fundemental Theorem of 1D Projective Geometry

Recall the question we ended the section regarding 1D projectivities with: consider a projectivity from $l$ to $l'$ that takes $A, B, C$ to $l$ to $A', B', C'$ to $l'$. We've shown the existance of such projectivities by construction. Is the resulting projectivity unique? two such projectivities, $T_{1}$ and $T_{2}$. Notice that the composition $T_{1}^{-1} \circ T_{2}$ is a projectivity from $l$ to $l$ which fixes $A, B, C$, and thus by the three fixed points theorem is the identity projectivity. However, since the maps are bijective it follows that $T_{2}^{-1} \circ T_{2}$ is also the identity map, which means $T_{2}^{-1}=T_{1}^{-1}$, which proves that the projectivity is unqiue. This result is known as the fundemental theorem of 1D projective geometry:

*Given two lines $l$ and $l'$ in $P^{3}$ and given distinct points $A, B, C$ on $l$ and $A', B', C'$ to $l'$, there exists a unique projectivity $l \to l'$ taking $A, B, C$ to $A', B', C'$*.


## Pappus' Hexagon Theorem

One famous theorem in projective geometry is Pappus' Hexagon theorem, which states the following: given two distinct lines $l$ and $l'$ in $P^{2}$ and distinct points $A, B, C$ on $l$ and $A', B', C'$ on $l'$, the pairs of lines through $AB'$ and $BA'$, $AC'$ and $CA'$, and $BC'$ and $CB'$, all interesect at points $P_{AB}, P_{AC}$ and $P_{BC}$ respectively, and $P_{AB}, P_{AC}$ and $P_{BC}$ are collinear. It is illustrated in the following sketch:

![Pappus' Hexagon Theorem](images/pappus_theorem.png)

We can easily prove it using the 1D fundemental theorem (abbreviated as 1DFT). The idea here is to use two criss-cross constructions and prove that the intermediate line (which we called $m_{B}$ is our introduction of this construction) is the same for both constructions. Recall that in our criss-cross construction around $B$, we denoted the line through $P_{AB}$ and $P_{BC}$ as $m_{B}$. We can use the same construction around $C$ and get the line $m_{C}$ defined as the line through $P_{AC}$ and $P_{BC}$. To prove the theorem, we need to show that $m_{B}$ is the same as $m_{C}$.

Consider the intersection of $m_{B}$ with $l$, and the intersection of $m_{C}$ with $l$. If we can prove that the points are in fact the same, and given that both lines are incident at $P_{BC}$, we can show that they are in fact the same line, proving Pappus' theorem.

Consider the projectivity created by the criss-cross construction around $B$, denoted $T_{B}$, and the projectivity around $C$ denoted $T_{C}$. They take $A, B, C$ on $l$ to $A', B', C'$ on $l'$, and thus by 1DFT are the same projectivity, and specifically they both fix the intersection of $l$ and $l'$ (which must intersect since they are coplanar in $P^{2}$). By the construction of the projectivity, we identify that the point $l \cap l'$ is the image of $l cap m_{C}$ in $T_{B}$ and $l \cap m_{C}$ in $T_{C}$, so we have $T_{C}(l \cap m_{C})=T_{B}(l \cap m_{B})=l \cap l'$. However, since projectivities are bijective, and since $T_{B}=T_{C}$, we get $l \cap m_{C} = l \cap m_{B}$. Since this point is incident with both $m_{C}$ and $m_{B}$, we have $m_{C}$ and $m_{B}$ incident at two points, meaning they are in fact the same line, proving the theorem.

## Fundemental Theorem of 2D Projective Geometry

Let us return to the setting where we presented projectivities - namely the two dimesional case, mapping between two planes (2D) in $P^{3}$. We can generalize the 1DFT to this case as follows:

Given two plane $\pi$ and $\pi'$ in $P^{3}$ and two ordered sets of points $\{A, B, C, D\} \subset \pi$ and $\{A', B', C', D'\} \subset \pi'$, where in each set no three points are collinear (so both sets can span the plane), there exists a unique projectivity from $\pi$ to $\pi'$ taking $\{A, B, C, D\}$ to $\{A', B', C', D'\}$.

![Fundemental theorem of 2D projective geometry](images/fundemental_theorem_2d.png)

### Existence

Consider the lines $AD$, $BC$. The lines are coplanar and distinct so they are incident at some point $E$. Similarly, consider $A'D'$ and $B'C'$, which are incident at some point $E'$ by the same argument. By the 1D version of the fundemental theorem, we know that there exists a projectivity from $BC$ to $B'C'$ taking $B, C, E$ to $B', C', E'$, and while the 1D projectivity is unique (in the sense that the map from $BC$ to $B'C'$ under these conditions is unique), the same is not true with regards to where the projectivity takes the rest of the plane. It is trivial to find one such perspectivity from $\pi$ to some plane $\pi^{*}$ such that $\pi^{*} \ne \pi'$, which would of course contain the line through $B'C'$. This projectivity takes $A, D$ to points $A^{*}, D^{*} \in \pi^{*}$. However since projectivities preserve incidence relations we have $A^{*}D^{*}$ incident with $B'C'$ at $E'$. Since $B'C'$ and $A^{*}D^{*}$ are incident at $E'$ they are coplanar and we can construct a perspectivity from $\pi$ to $\pi'$ centered at $A^{*}D' \cap A'D^{*}$, as illustrated:

![existence of projection between non-coplanar quadrilateral](images/existence_ftpg2.png)

Notice that by the definition of a perspectivity, the line over which the planes intersect is fixed, thus the perspectivity takes $A^{*}$ to $A'$, $D^{*}$ to $D'$, $C'$ to $C'$ and $B'$ to $B'$. By composing the projectivity from $\pi$ to $\pi^{*}$ with this perspectivity from $\pi^{*}$ to $\pi'$, we get a projectivitiy $\pi \to \pi'$ such that $\{A, B, C, D\}$ gets taken to $\{A', B', C', D'\}$, thus showing the existence of such projectivity.

### Four Fixed Points Theorem

Consider a projectivity from $\pi$ to itself which fixes four points $A, B, C, D$, no three of which collinear. Again we begin by extending $AB$ and $CD$ until they meet at some point $E$, and $AD$ and $BC$ until they meet at some point $K$.

![Setup for the four fixed points theorem proof](images/four_fixed_points_theorem_setup.png)

Since the projectivity maps lines to lines and it maps $AB$ to a line through $AB$ and $CD$ to a line through $CD$ (the somewhat odd wording is intentional - projectivities don't preserve lines so until we show that the projectivity acts as the identity on those lines we cannot assume that the line is preserved in its entirety including distances between points, but rather just that the line as a set gets taken to itself as a set), however since their intersection is preseved under a projectivity we also get $E$ on $AB$ taken to $E$, meaning we have three fixed points along $AB$, and similarly three fixed points along $CD$, thus by the three fixed points theorem both lines are fixed pointwise (i.e. each point along each line gets taken to itself). By the same argument we can show that $AD$ and $BC$ are fixed pointwise.

Consider any line $l$ on $\pi$. Since $\pi$ is a projective plane, any two distinct lines are incident at a unique point. This means that $l$ is incident with all four lines $AB, CD, AD, BC$, which define a set of 4 points, not necessarily unique: $l$ can be parallel to one of the edges of the quadrilateral $ABCD$, in which case we wil have 3 distinct points of intersection - two at regular points in $R^{2}$, and one at infinity. In any case, we have at least three distinct points along $l$ which are also on lines which are fixed pointwise, meaning these points are also fixed by the projectivity, and by the three fixed points theorem we can say that $l$ is fixed as well. Since $\pi$ is the union of all such lines, this shows that this projectivity is, in fact, an identity map from $\pi$ to itself. This result is called the four fixed point theorem: a projectivity in $P^{3}$ from a plane to itself which fixes the edges of a quadrilateral is the identity map.

### Uniqueness

Using the four fixed points theorem, we can show that a projectivity in projective space that takes a quadrilateral on one plane to a quadrilateral on another plane is unqiue by the same argument we used to show uniqueness in the fundemental theorem of 1 dimensional projective geometry.

### So, What Changes Under Projection?

One of our main goals in our discussion of projective geometry is understanding what changes under perspective shifts, what stays the same, and what are the possible images of a domain under a projectivity. In our discussion of perspectivities and projectivities, we have shown how these constructs can be used to model the way we see through our eyes, the way shadows are formed, and how cameras are used to capture the world, and we have seen how all of these are, in a mathematical sense, identical. Furthermore, we have seen by the fundamental theorem of projective geometry, that homographies from lines are determined by three distinct points, and that homographies between planes are determined by the four vertices of a quadrilateral. We have seen that incidence relations are preserved, and that lines get taken to lines. We examined perspectivities centered at a point in $R^{3}$, called central perspectivites, and perspectivities centered at a point at infinity, called parallel perspectivities. However, we still haven't come across any insight on how one may derive measurements from projective images, let alone developed an analytical framework to work with in projective spaces (except for the isomorphism with mobius transforms, which we still haven't proven). These tools are necessary for engineering, and so we will dedicate the rest of our discussion slowly turning away from the realm of synthetic geometry and towards analytical frameworks and matrix representations of projections which are extremely important in the field of computer graphics. 

## The Cross-Ratio

Consider an ordered set of 4 collinear points $A, B, C, D$ in $P^{3}$.

![cross ratio](images/cross_ratio.png)

Consider a signed segment length scheme, where $AB=-BA$. Consider the ratio

$$
\frac{AB}{BC} \div \frac{AD}{DC}
$$

We call this ratio the *cross-ratio* (denoted $(A, B;C, D)$), and as we are about to see, it is *invariant* under projective maps. This means that given a projectivity $\pi \to \pi'$ which takes an ordered set of collinear points $\{A, B, C, D\}$ to an ordered set of points $\{A', B', C', D'\}$, the cross ratio of $A, B, C, D$ will be the same as the cross ratio of $A', B', C', D'$. This result can be use to determine the Euclidean distance between two points in a projective image, and can also be used to transform one projectivity to another, for example in image processing.

It is fairly trivial to show that the cross ratio is injetive - if $(A, B;C, D)=(A',B;C,D)$, it follows that $X=A'$. This can by expanding the notation and observing that we end up with a linear equation whose only solution is $X=A'$. This property can be used to provide an alternative, perhaps more straight-forward proof for the three fixed points theorem: let $T$ be a 1 dimensional perspectivity $l \to l$ such that it fixes three points $B, C, D$ on $l$. Let $X$ be an arbitrary point on $l$. By the invariance of the cross ratio, we have $(X,B;C,D)=(T(X),B;C,D)$. By the injective property, we get $X=T(X)$ for every $X$ on $l$, thus we get that $T$ is the identity map on $l$ (or, as we sometimes say instead, fixes $l$ pointwise). 

### Dual Notation

Consider an ordered set of 4 points $A, B, C, D$ on a line $l$ in $P^{3}$, and some point $P$ not collinear with the points. Connect $P$ to $A, B, C, D$, and denote these lines as $a, b, c, d$ respectively. Let $h$ be the size of the line from $P$ perpendicular to $l$.

![dual notation of the cross-ratio](images/cross_ratio_dual.png)

We define the cross-ratio of the lines $a, b, c, d$ by the cross ratio of the sine of the signed angels between these lines (meaning that $\angle APB = -\angle BPA$) as follows:

$$
\frac{\sin(\angle APB)}{\sin(\angle BPC)}\div\frac{\sin(\angle APD)}{\sin(\angle DPC)}
$$

Consider the 4 triangles $\triangle APB$, $\triangle BPC$, $\triangle APD$, $\triangle DPC$. We can calculate the area of a triangle using trigonometry or pure geometry, so we have:

$$
\begin{gathered}
S_{\triangle APB} = \frac{1}{2}h \cdot AB = \frac{1}{2}AP \cdot PB \cdot \sin(\angle(APB)) \Rightarrow \\
\sin(\angle APB) = \frac{h \cdot AB}{AP \cdot PB}
\end{gathered}
$$

And so on for the other three triangles. By replacing the sine terms in the definition with this result, we get:

$$
\begin{gathered}
\frac{\sin(\angle APB)}{\sin(\angle BPC)} \div \frac{\sin(\angle APD)}{\sin(\angle DPC)} = \\
\frac{\frac{h \cdot AB}{AP \cdot PB}}{\frac{h \cdot BC}{BP \cdot PC}} \div \frac{\frac{h \cdot AD}{AP \cdot PD}}{\frac{h \cdot DC}{DP \cdot PC}} = \\
\frac{AB \cdot BP \cdot PC}{AP \cdot PB \cdot BC} \cdot \frac{AP \cdot PD \cdot DC}{AD \cdot DP \cdot PC} = \\
\frac{AB \cdot BP}{BC \cdot (-BP)} \cdot \frac{DC \cdot PD}{AD\cdot (-PD)} = \\
\frac{AB}{BC} \div \frac{AD}{DC}
\end{gathered}
$$

Which is exactly the definition of the cross-ratio for points, proving the dual equivalance. This means that the cross-ratio is invariant under a perspectivity iff its dual is.

### Dual Invariance

Consider the cross-ratio as defined for lines. We have shown that the cross ratio for lines depends only on the angle between $P$ and the line towards the collinear points $A, B, C, D$. Consider a perspectivity centered at some point $O$ from $\pi$ to $\pi'$ taking the points $A, B, C, D$ on $\pi$ to points $A', B', C', D'$ on $\pi'$. By definition the line through $O$ and $A$ hits $\pi'$ at $A'$, and so on, meaning that the angle $APB$ is in fact the same as $A'PB'$, and so forth, meaning that the cross-ratio of the lines through $O$ and $A, B, C, D$ is invaraint under a perspectivity, which means that the dual notation - cross-ratio of points - is also invariant under a perspectivity. 

This is the first tool so far that lets us run some actual calculations, and lets us extract meaningful information from a projective image regarding its "true" Euclidean nature. Consider for example four equally spaced collinear points. By working out the map from a top-down view, we get:

$$
(A,B;C,D)=\frac{1}{1} \div \frac{3}{-1}=-\frac{1}{3}
$$

Since this result is invariant under a perspectivity, and as such invariant under a projectivity (since projectivities are compositions of perspectivities), we can use this result to determine if collinear points are equally spaced. It would seem as if our eyes are rather well-tuned to this invariance, and it is one of the cues that lets us perceive distances in 3D space.

### Cross Ratio as Mobius Transforms

We can use the cross product to write 1 dimensional projectivites as a function: Consider a 1D projectivity $\Gamma: l \to l'$ which takes $A, B, C$ on $l$ to $0, 1, \infty$ on $l'$ respectively. Let $O$ on $l$ be the origin, or $0$, and let $A, B, C$ be at distances $a, b, c$ from $0$, respectively. Let $X$ be another point on $l$ at distance $x$ from $O$, then the cross ratio of the images of $A, B, C, X$ under the perspectivity is given by:

$$
\begin{gathered}
(\Gamma(A), \Gamma(B);\Gamma(C), \Gamma(X)) = \frac{\Gamma(B)-\Gamma(A)}{\Gamma(C)-\Gamma(B)} \div \frac{\Gamma(X)-\Gamma(A)}{\Gamma(C)-\Gamma(X)} = \\
\frac{1}{\Gamma(B) - 1} \div \frac{\Gamma(X)}{\Gamma(B) - \Gamma(X)} = \frac{\Gamma(B) - \Gamma(X)}{\Gamma(B) \Gamma(X) - \Gamma(X)} = \frac{1 - \frac{\Gamma(X)}{\Gamma(B)}}{\Gamma(X) - \frac{\Gamma(X)}{\Gamma(B)}} \underset{\Gamma(B)=\infty}{=}\frac{1}{\Gamma(X)}
\end{gathered}
$$

By the invariance of the cross ratio:

$$
\begin{gathered}
(A,B;C,D) = (\Gamma(A), \Gamma(B);\Gamma(C), \Gamma(X)) = \frac{1}{\Gamma(X)} \\
\Gamma(X) = \frac{1}{A,B;C,D} = \frac{1}{\frac{b-a}{c-b} \div \frac{x-a}{c-x}} = \frac{c-b}{b-a} \cdot \frac{c-x}{x-a}
\end{gathered}
$$

$\Gamma(X)$ is a one-variable function, taking $X$ to its image under the perspectivity. This is the first time that we have presented an algebraic means of transforming points under a projectivity.

Note that $a, b, c$ are fixed, so the term $\frac{c-b}{b-a}$ can be replaced by some constant $k_{0}$. Similarly, we can rewrite $c-x$ as $x-c$ and factor out he negative sign to be a part of the constant $k=-k_{0}$, and so we can rewrite this as:

$$
\Gamma(X) = \frac{kx-kc}{x-a} \underset{m=-kc,n=-a}{=}\frac{kx+m}{x+n}
$$

This is a linear fractional function that greatly resambles a mobius transform. In fact, the only difference is that, if we were to equate the coefficients of this function with those of a general mobius transform, we will see that it is a mobius transform where $c=1$. However, recall that scaling the matrix of coefficients $A$ does not change the mobius transform, so under the assumption that $c \ne 0$ we can use the equivalance relation $A=\alpha A$ and multiply $A$ by $\frac{1}{c}$ (note that here all the coefficients are real numbers whereis in a mobius transform we also consider complex coefficients), thus we can define an isomorphism between $\Gamma(X)$ and a mobius transform, however since $\Gamma(X)$ is isomorphic to a projectivity (as per the fundemental theorem of 1D projective geometry), we can say that 1 dimensional projectivities are isomorphic to mobius transforms, thus proving the lema we used in our first proof of the three fixed points theorem.

## Real Projective Plane

Consider our construction of the projective plane $P^{2}$. We constructed $P^{2}$ as $R^{2} \cup l_{\infty}$, where $l_{\infty}$ is the set of all points at infinity associated with each family of parallel lines. As we have seen, such constuction is hard to visualize and reason about - as we have seen, lines have a circular property, and also the points at infinity seem somewhat arbitrary and detached from our regular notion of points. Indeed, the construction we have used is not very nice from an analytical standpoint. Let's try to shift our perspective: recall that, by the fundemental theorem of 2D projective geometry, a perspectivity is uniquely defined by four vertices of a quadrilateral, thus the entire projective plane is determined by these 4 points, and these 4 points are the intersection of the projective plane with lines passing through the center of perspectivity. It is tempting, then, to think of a point under a perspectivity as lines through the center of perspectivity. Indeed, for any two planes $\pi_{1}, \pi_{2}$, the intersections of a line $l$ through the center of perspectivity with the planes determine where the perspectivity takes the point, so from the center of perspectivity the points are in fact identical.

![Perspectivities as lines through the origin](images/perspectivity_revisited.png)

Let us attach cartesian coordinates to $R^{3}$ such that the origin is at the center of perspectivity. Under this construction, lines through the center of perspectivity are lines through the origin. Consider two affine planes in $R^{3}$ (planes which do not pass through the origin), and let $l$ be a line through the origin. Denote the points $X$ and $X'$ as the intersection of the line with the planes (we will handle the case where the line is parallel to one of the planes in a bit, let's ignore it for now). By definition, the perspectivity maps $X$ to $X'$, which motivates us to define a new object - the projective point - which is a line in $R^{3}$ passing through the origin. Similarly, we wish to define a projective line as a set of projective points. We define the projective line as a plane in $R^{3}$ though the origin. Consider that the intersection of two planes in $R^{3}$ is over a line, or the empty set, thus this definition is only natural. We say that a projective point and a projective line are incident if the projective point is contained within the projective line, and say that two projective lines are incident over a projective point if the planes they represent intersect over a line through the origin (which is a projective point).

This new structure is still incomplete, as we still haven't dealt with the points at infinity. How can we express the points at infinity and the line at infinity under this construction? Consider the following illustration of a perspectivity of some line:

![Following a line under a perspectivity](images/tracing_a_line_under_perspectivity.png)

As we tend towards infinity (in either direction), we see that the line through the center of perspectivity becomes more and more parallel to the line, until the lines are parallel in $R^{3}$ and thus do not interesect. Observe that regardless of the direction along the line we choose to take, the line through the origin ends up being the same. If we were to parametrize the line along which we are following as $v_{0}+\vec{v}t$, we could see that as $t \to \pm \infty$, the projective point ends up being the line through the origin $\vec{v}$. This is exactly the projective point which matches the illusive point at infinity, and indeed in the projective space $P^{3}$ the line represented by the projective point and the line on the plane will intersect at a point at infinity since they are parallel. The line at infinity, then, is achieved by the projective line that is the plane through the origin parallel to the affine plane being examined under the perspectivity (altenatively, we can say that it is in fact the subject affine plane with the translation removed, which is in fact a vector space). If this paragraph reads a bit too handwavy then don't worry, we' ll formalize these arguments later and prove them. For now, appreciate the fact that assuming these arguments do hold, then this new construction is in many ways more natural and more attainable than the extended Euclidean plane we have discussed before - in this new structure, points and lines at infinity are no different than any other projective point and projective line in $R^{3}$. Also, the circular nature of lines in a projective space is captured nicely and naturely by this construction.

Let's make these ideas more explicit by introducing a new incidence structure, called the *Real Projective Plane* $RP^2$, which consists of:
1. Projective points, which are lines through the origin in $R^{3}$.
2. Projective lines, which are planes through the origin in $R^{3}$.
3. An incidence relation between projective points and projective lines:
   1. A projective point is incident with a projective line where the respective line and plane through the origin are incident in $R^{3}$.
   2. Two projective lines are incident at a projective point determined by the line over which their respective planes are incident in $R^{3}$.
   3. Two projective points are incident with a projective line which is a plane through the origin containing the lines representing both projective points, in $R^{3}$.

This construction is a linear space:
1. Any two distinct projective points are lines through the origin thus they span one unique plane which is a projective line.
2. Any projective line is a plane through the origin and thus includes infintely many distinct lines through the origin which are projective points.

And also a projective space:
1. Projective points are lines through the origin, thus any two distinct projective points span a plane through the origin, which is a projective line, thus any two distinct projective points are incident with exactly one projective line.
2. Projective points are planes through the origin. Planes through the origin share a point (the origin), and thus are incident over a line through the origin, which is a projective line. Thus any two distinct projective lines ar incident with exactly one projective point.

## Homogenous Coordinates

In $P^{3}$, it was not easy to attach a coordinate system. When trying to attach one to $P^{2}$ or $P^{3}$, queestion such as how would we handle lines and points at infinity, how would we handle different images of the same plane, and so on, naturally arise. Luckily, in $RP^{2}$ this is much more trivial: we would like to attach coordinates to points in $RP^{2}$. Recall that projective points are lines through the origin, so the natural thing to do would be to use the parametrization of the line through the origin, given by $\lambda \vec{v}$, where $\vec{v}$ is the direction of the line in $R^{3}$, and thus is non zero. However, since $\forall \lambda \ne 0$, the paramterization $\lambda \vec{v}$ represnts the same line, and thus the same projective point, we can define an equivalance relation on all elements of $R^{3}/\{0\}$ (the reason we forget the origin is that when $\vec{v}=\vec{0}$, the formula is simply the origin and not a line and thus not a projective point) such that $(x, y, z)=\lambda(x, y, z)$ for $\lambda \ne 0$. These notion is called *homogenous coordinates*, and is usually denoted using a different notation so as not to conflate with the notation for points in Euclidean space. One popular notation is $[x:y:z]=\lambda[x:y:z]$.

Since we forget the origin, we can also say that there is no homogenous coordinate where $[x:y:z]=[0:0:0]$, so we can attach a coordinate system such that the $z$ axis is in the direction of the non-zero component, and then we can rewrite $[x:y:z]=[\frac{x}{z}:\frac{y}{z}:1]$, and take the latter as the representative value for the homogenous point.

Using homogenous coordinates, it is trivial to show that parallel lines intersect at a single point in $RP^{2}$. In fact, this is remarkbly similar to the calculations we've done when discussing the camera obscura, although we didn't have a proper framework for the calculations at the time.

Homogenous coordinates, along with the construction of $RP^{2}$, provide an analytical framework when dealing with projective geometry. For example, we can now provide an analytic proof for the fact that parallel lines intersect under a perspectivity:

Consider a line $R^{3}$, parametrized as $v_{0}+\vec{v}t=(x_{0}+xt,y_{0}+yt,z_{0}+zt)$. In $RP^{2}$, the line is taken to a plane through the origin, such that each point on the plane becomes a projective point, represented by the homogenous coordinate  $[x_{0}+xt:y_{0}+yt:z_{0}+zt]$. By definition of homogenous coordinate, we have:

$$
p_{t} = [x_{0}+xt:y_{0}+yt:z_{0}+zt] = [\frac{x_{0}+xt}{z_{0}+zt}:\frac{y_{0}+yt}{z_{0}+zt}:1] = 
[\frac{\frac{x_{0}}{t}+x}{\frac{z_{0}}{t}+z}:\frac{\frac{y_{0}}{t}+y}{\frac{z_{0}}{t}+z}:1]
$$

In the limit $t \to \infty$, we get:

$$
\lim_{t \to \infty} p_{t} = [\frac{x}{z}:\frac{y}{z}:1]
$$

Thus using homogenous coordinates we can see that the line converges to a point $p_{\infty}=[\frac{x}{z}:\frac{y}{z}:1]$, which is independent of the origin of the line $v_{0}$, thus all lines parallel to the original line intersect at the same projective point in $RP^{2}!

## Projective Maps

Observe that the cross ratio and collinearities are the only properties preserved and projectivities, which motivates defining projective maps - maps from $P \to P'$ where $P, P'$ are both projective spaces - as maps which preserve the cross ratio and are collineations. We have already shown a projective map between two 1 dimensional projective planes - the mobius transform $\mathbb{C} \to \mathbb{C}$ which can also map $P^{1} \to P^{1}$, which is represented by a matrix from the group $PGL(2, R)$. We can expand this notion to 2 dimensional projective spaces, by taking a matrix from the group $PGL(3, R)$, such that:

$$
A = 
\begin{pmatrix}
a & b & c \\
d & e & f \\
g & h & 1
\end{pmatrix}
$$

We will show that $A$ maintains the structure of $RP^{2}$. To show this, consider a line through the origin in $R^{3}$. Since a line through the origin is a vector space, and since $A$ is a linear transformation, the image of the line through the origin under the transfromation $A$ is also a line through the origin, which means that projective points get taken to projective points. A similar argument shows that projective lines are taken to projective lines, and it is trivial to check that $A$ preserves collineations in $RP^{2}$ (meaning that it preserves incidence relations of planes and lines through the origin in $R^{3}$), thus $A$ is a projective map from $RP^{2} \to RP^{2}$.

Recall that an affine transformation $A^{2} \to A^{2}$ is a $3 \times 3$ matrix of the form

$$
\left(
\begin{array}{cc|c}
a & b & t_{1} \\
c & d & t_{2} \\
0 & 0 & 1
\end{array}
\right)
$$

Where $(t_{1}, t_{2})$ denotes the translation. From this, it is clear that $\text{Aff}(2, R) \subset PGL(3, R)$. This can trivially be generalized to higher dimensions to show that $\text{Aff}(n-1, R) \subset PGL(n, R)$.

## Affine Maps of RP(2, R)

Since $\text{Aff}(2, R) \subset PGL(3, R)$, we can map projective spaces to affine spaces. However, since affine spaces maintain parallelism, the hyperplane at infinity must be removed from the projective space. This is done by taking a hyperplane through the origin parallel to the affine space, and removing it from the projective space. 

For example, mapping $RP^{2}$ to the affine plane $z=1$ can be done by removing the line at infinity $z=0$, which remains fixed under the affine matrix:

$$
\begin{pmatrix}
a & b & t_{1} \\
c & d & t_{1} \\
0 & 0 & 1
\end{pmatrix}
[x:y:0]
=
[x':y':0]
$$

However, since any other projective point can be written as $[x:y:1]$ under homogenous coordinates, it is easy to see that the map takes all other projective points to point in the affine plane, thus the map is a bijection between $RP^{2}/\{z=0\}$ and the affine plane $z=1$. This provides us with a nice way of viewing projective lines and points as lines and points in a way that is more familiar to us. In fact, our perspective drawing accurately captures this structure. This also provides us with a nice way of reasoning about points at infinity - points at infinity can now be visualized as lines in the associated vector space of the affine plane $z=1$, which is the $XY$ plane.

# Soon
orthographic vs perpsective and central projection matrix in 3D graphics
